import re
import pysrt

spelling_corrections_dict = {
    # movie specific
    
    # l's and I's
    'l ': 'I ',
    "lI": "ll",
    "l'm": "I'm",
    "l'll": "I'll",
    "l've": "I've",
    "lf": "If",
    "lt": "It",
    "lt's": "It's",
    "lsn't": "Isn't",
    "aIthough": "although",
    "AIthough": "Although",
    "AlI right": "Alright",
    "All right": "Alright",
    "Allright": "Alright",
    "allright": "alright",
    "all right": "alright",
    "alI right": "alright",
    "cereaI": "cereal",
    "CereaI": "Cereal",
    "reaI": "real",
    "ReaI": "Real",
    "schooI": "school",
    "SchooI": "School",
    "successfuI": "successful",
    "SuccessfuI": "Successful",

    # -or/-our words
    'color': 'colour',
    'Color': 'Colour',
    'colors': 'colours',
    'Colors': 'Colours',
    'coloring': 'colouring',
    'Coloring': 'Colouring',
    'colorful': 'colourful',
    'Colorful': 'Colourful',
    'armor': 'armour',
    'Armor': 'Armour',
    'favor': 'favour',
    'Favor': 'Favour',
    'favors': 'favours',
    'Favors': 'Favours',
    'flavor': 'flavour',
    'Flavor': 'Flavour',
    'flavors': 'flavours',
    'Flavors': 'Flavours',
    'harbor': 'harbour',
    'Harbor': 'Harbour',
    'harbors': 'harbours',
    'Harbors': 'Harbours',
    'honor': 'honour',
    'Honor': 'Honour',
    'honors': 'honours',
    'Honors': 'Honours',
    'humor': 'humour',
    'Humor': 'Humour',
    'labor': 'labour',
    'Labor': 'Labour',
    'neighbor': 'neighbour',
    'Neighbor': 'Neighbour',
    'neighbors': 'neighbours',
    'Neighbors': 'Neighbours',
    'odor': 'odour',
    'Odor': 'Odour',
    'odors': 'odours',
    'Odors': 'Odours',
    'rumor': 'rumour',
    'Rumor': 'Rumour',
    'rumors': 'rumours',
    'Rumors': 'Rumours',
    'splendor': 'splendour',
    'Splendor': 'Splendour',
    'valor': 'valour',
    'Valor': 'Valour',
    'ardor': 'ardour',
    'Ardor': 'Ardour',
    'clamor': 'clamour',
    'Clamor': 'Clamour',
    'demeanor': 'demeanour',
    'Demeanor': 'Demeanour',
    'fervor': 'fervour',
    'Fervor': 'Fervour',
    'glamor': 'glamour',
    'Glamor': 'Glamour',
    'rigor': 'rigour',
    'Rigor': 'Rigour',
    'savior': 'saviour',
    'Savior': 'Saviour',
    'savor': 'savour',
    'Savor': 'Savour',
    'savors': 'savours',
    'Savors': 'Savours',
    'vigor': 'vigour',
    'Vigor': 'Vigour',

    # -er/-re words
    'center': 'centre',
    'Center': 'Centre',
    'centers': 'centres',
    'Centers': 'Centres',
    'fiber': 'fibre',
    'Fiber': 'Fibre',
    'fibers': 'fibres',
    'Fibers': 'Fibres',
    'liter': 'litre',
    'Liter': 'Litre',
    'liters': 'litres',
    'Liters': 'Litres',
    'meter': 'metre',
    'Meter': 'Metre',
    'meters': 'metres',
    'Meters': 'Metres',
    'kilometer': 'kilometre',
    'Kilometer': 'Kilometre',
    'kilometers': 'kilometres',
    'Kilometers': 'Kilometres',
    'theater': 'theatre',
    'Theater': 'Theatre',
    'theaters': 'theatres',
    'Theaters': 'Theatres',
    'caliber': 'calibre',
    'Caliber': 'Calibre',
    'luster': 'lustre',
    'Luster': 'Lustre',
    'miter': 'mitre',
    'Miter': 'Mitre',
    'saber': 'sabre',
    'Saber': 'Sabre',
    'sabers': 'sabres',
    'Sabers': 'Sabres',
    'specter': 'spectre',
    'Specter': 'Spectre',
    'specters': 'spectres',
    'Specters': 'Spectres',

    # -ize/-ise words
    'appetizer': 'appetiser',
    'Appetizer': 'Appetiser',
    'appetizers': 'appetisers',
    'Appetizers': 'Appetisers',
    'computerize': 'computerise',
    'Computerize': 'Computerise',
    'computerizes': 'computerises',
    'Computerizes': 'Computerises',
    'customize': 'customise',
    'Customize': 'Customise',
    'customizes': 'customises',
    'Customizes': 'Customises',
    'dramatize': 'dramatise',
    'Dramatize': 'Dramatise',
    'dramatizes': 'dramatises',
    'Dramatizes': 'Dramatises',
    'energize': 'energise',
    'Energize': 'Energise',
    'energizes': 'energises',
    'Energizes': 'Energises',
    'finalize': 'finalise',
    'Finalize': 'Finalise',
    'finalizes': 'finalises',
    'Finalizes': 'Finalises',
    'memorize': 'memorise',
    'Memorize': 'Memorise',
    'memorizes': 'memorises',
    'Memorizes': 'Memorises',
    'prioritize': 'prioritise',
    'Prioritize': 'Prioritise',
    'prioritizes': 'prioritises',
    'Prioritizes': 'Prioritises',
    'revolutionize': 'revolutionise',
    'Revolutionize': 'Revolutionise',
    'revolutionizes': 'revolutionises',
    'Revolutionizes': 'Revolutionises',
    'synchronize': 'synchronise',
    'Synchronize': 'Synchronise',
    'synchronizes': 'synchronises',
    'Synchronizes': 'Synchronises',
    'apologize': 'apologise',
    'Apologize': 'Apologise',
    'apologizes': 'apologises',
    'Apologizes': 'Apologises',
    'authorize': 'authorise',
    'Authorize': 'Authorise',
    'authorizes': 'authorises',
    'Authorizes': 'Authorises',
    'capitalize': 'capitalise',
    'Capitalize': 'Capitalise',
    'capitalizes': 'capitalises',
    'Capitalizes': 'Capitalises',
    'criticize': 'criticise',
    'Criticize': 'Criticise',
    'criticizes': 'criticises',
    'Criticizes': 'Criticises',
    'realize': 'realise',
    'Realize': 'Realise',
    'realizes': 'realises',
    'Realizes': 'Realises',
    'recognize': 'recognise',
    'Recognize': 'Recognise',
    'recognizes': 'recognises',
    'Recognizes': 'Recognises',
    'summarize': 'summarise',
    'Summarize': 'Summarise',
    'summarizes': 'summarises',
    'Summarizes': 'Summarises',

    # -yze/-yse words
    'dialyze': 'dialyse',
    'Dialyze': 'Dialyse',
    'dialyzes': 'dialyses',
    'Dialyzes': 'Dialyses',
    'hydrolyze': 'hydrolyse',
    'Hydrolyze': 'Hydrolyse',
    'hydrolyzes': 'hydrolyses',
    'Hydrolyzes': 'Hydrolyses',
    'analyze': 'analyse',
    'Analyze': 'Analyse',
    'analyzes': 'analyses',
    'Analyzes': 'Analyses',
    'catalyze': 'catalyse',
    'Catalyze': 'Catalyse',
    'catalyzes': 'catalyses',
    'Catalyzes': 'Catalyses',
    'paralyze': 'paralyse',
    'Paralyze': 'Paralyse',
    'paralyzes': 'paralyses',
    'Paralyzes': 'Paralyses',

    # -og/-ogue words
    'analog': 'analogue',
    'Analog': 'Analogue',
    'analogs': 'analogues',
    'Analogs': 'Analogues',
    'catalog': 'catalogue',
    'Catalog': 'Catalogue',
    'catalogs': 'catalogues',
    'Catalogs': 'Catalogues',
    'dialog': 'dialogue',
    'Dialog': 'Dialogue',
    'dialogs': 'dialogues',
    'Dialogs': 'Dialogues',
    'monolog': 'monologue',
    'Monolog': 'Monologue',
    'monologs': 'monologues',
    'Monologs': 'Monologues',

    # Words with dropped 'e'
    'aging': 'ageing',
    'Aging': 'Ageing',
    'livable': 'liveable',
    'Livable': 'Liveable',
    'lovable': 'loveable',
    'Lovable': 'Loveable',
    'movable': 'moveable',
    'Movable': 'Moveable',
    'sizeable': 'sizeable',
    'Sizeable': 'Sizeable',
    'acknowledgment': 'acknowledgement',
    'Acknowledgment': 'Acknowledgement',
    'acknowledgments': 'acknowledgements',
    'Acknowledgments': 'Acknowledgements',
    'esthete': 'aesthete',
    'Esthete': 'Aesthete',
    'esthetes': 'aesthetes',
    'Esthetes': 'Aesthetes',
    'salable': 'saleable',
    'Salable': 'Saleable',

    # Words with single vs double consonants
    'canceled': 'cancelled',
    'Canceled': 'Cancelled',
    'canceling': 'cancelling',
    'Canceling': 'Cancelling',
    'counselor': 'counsellor',
    'Counselor': 'Counsellor',
    'counselors': 'counsellors',
    'Counselors': 'Counsellors',
    'jewelry': 'jewellery',
    'Jewelry': 'Jewellery',
    'labeled': 'labelled',
    'Labeled': 'Labelled',
    'labeling': 'labelling',
    'Labeling': 'Labelling',
    'modeled': 'modelled',
    'Modeled': 'Modelled',
    'modeling': 'modelling',
    'Modeling': 'Modelling',
    'traveled': 'travelled',
    'Traveled': 'Travelled',
    'traveling': 'travelling',
    'Traveling': 'Travelling',
    'fulfillment': 'fulfilment',
    'Fulfillment': 'Fulfilment',
    'installment': 'instalment',
    'Installment': 'Instalment',
    'installments': 'instalments',
    'Installments': 'Instalments',
    'skillful': 'skilful',
    'Skillful': 'Skilful',
    'willful': 'wilful',
    'Willful': 'Wilful',

    # Miscellaneous differences
    'aluminum': 'aluminium',
    'Aluminum': 'Aluminium',
    'cozy': 'cosy',
    'Cozy': 'Cosy',
    'cozier': 'cosier',
    'Cozier': 'Cosier',
    'coziest': 'cosiest',
    'Coziest': 'Cosiest',
    'defense': 'defence',
    'Defense': 'Defence',
    'defenses': 'defences',
    'Defenses': 'Defences',
    'gray': 'grey',
    'Gray': 'Grey',
    'judgment': 'judgement',
    'Judgment': 'Judgement',
    'judgments': 'judgements',
    'Judgments': 'Judgements',
    'license': 'licence',
    'License': 'Licence',
    'licenses': 'licences',
    'Licenses': 'Licences',
    'pajamas': 'pyjamas',
    'Pajamas': 'Pyjamas',
    'ax': 'axe',
    'Ax': 'Axe',
    'axes': 'axes',
    'Axes': 'Axes',
    'busses': 'buses',
    'Busses': 'Buses',
    'distill': 'distil',
    'Distill': 'Distil',
    'distills': 'distils',
    'Distills': 'Distils',
    'donut': 'doughnut',
    'Donut': 'Doughnut',
    'donuts': 'doughnuts',
    'Donuts': 'Doughnuts',
    'inquire': 'enquire',
    'Inquire': 'Enquire',
    'inquires': 'enquires',
    'Inquires': 'Enquires',
    'inquiry': 'enquiry',
    'Inquiry': 'Enquiry',
    'inquiries': 'enquiries',
    'Inquiries': 'Enquiries',
    'maneuver': 'manoeuvre',
    'Maneuver': 'Manoeuvre',
    'maneuvers': 'manoeuvres',
    'Maneuvers': 'Manoeuvres',
    'mom': 'mum',
    'Mom': 'Mum',
    'moms': 'mums',
    'Moms': 'Mums',
    'plow': 'plough',
    'Plow': 'Plough',
    'plows': 'ploughs',
    'Plows': 'Ploughs',
    'skeptic': 'sceptic',
    'Skeptic': 'Sceptic',
    'skeptics': 'sceptics',
    'Skeptics': 'Sceptics',
    'sulfur': 'sulphur',
    'Sulfur': 'Sulphur',
    'whiskey': 'whisky',
    'Whiskey': 'Whisky',
    'whiskeys': 'whiskies',
    'Whiskeys': 'Whiskies',

    # Medical terms
    'anemia': 'anaemia',
    'Anemia': 'Anaemia',
    'cesarean': 'caesarean',
    'Cesarean': 'Caesarean',
    'diarrhea': 'diarrhoea',
    'Diarrhea': 'Diarrhoea',
    'esophagus': 'oesophagus',
    'Esophagus': 'Oesophagus',
    'estrogen': 'oestrogen',
    'Estrogen': 'Oestrogen',
    'gynecology': 'gynaecology',
    'Gynecology': 'Gynaecology',
    'hemoglobin': 'haemoglobin',
    'Hemoglobin': 'Haemoglobin',
    'pediatric': 'paediatric',
    'Pediatric': 'Paediatric',
    'pediatrician': 'paediatrician',
    'Pediatrician': 'Paediatrician',
    'pediatricians': 'paediatricians',
    'Pediatricians': 'Paediatricians',
    'ameba': 'amoeba',
    'Ameba': 'Amoeba',
    'amebas': 'amoebas',
    'Amebas': 'Amoebas',
    'edema': 'oedema',
    'Edema': 'Oedema',
    'leukemia': 'leukaemia',
    'Leukemia': 'Leukaemia',
    'orthopedic': 'orthopaedic',
    'Orthopedic': 'Orthopaedic'
}

def spelling_corrections(input_file, output_file):
    subs = pysrt.open(input_file)
    
    for sub in subs:
        # Apply word replacements (only for standalone words)
        for incorrect, correct in spelling_corrections_dict.items():
            # Use regex to replace only whole words
            sub.text = re.sub(r'\b{}\b'.format(re.escape(incorrect)), correct, sub.text)
    
    subs.save(output_file, encoding='utf-8')